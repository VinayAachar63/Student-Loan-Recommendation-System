<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Reset Password</title>
  <style>
    body { font-family: Poppins, sans-serif; background:#121921; color:white; display:flex; justify-content:center; align-items:center; height:100vh; }
    .card { background:rgba(255,255,255,0.05); padding:2rem; border-radius:12px; box-shadow:0 0 15px rgba(255,255,255,0.1); width:400px; text-align:center; }
    input,button{width:100%;padding:10px;margin:10px 0;border:none;border-radius:8px;}
    input{background:rgba(255,255,255,0.1);color:white;}
    button{background:#4caf50;color:white;font-weight:bold;cursor:pointer;}
    button:hover{background:#66bb6a;}
  </style>
</head>
<body>
  <div class="card">
    <h2>Reset Password</h2>
    <p>Enter your new password below.</p>
    <input type="password" id="newpass" placeholder="New password">
    <input type="password" id="confirmpass" placeholder="Confirm password">
    <button onclick="resetPassword()">Reset Password</button>
    <p id="msg"></p>
  </div>

  <script>
    const token = "{{ token }}";
    async function resetPassword(){
      const newpass=document.getElementById('newpass').value;
      const confirmpass=document.getElementById('confirmpass').value;
      const msg=document.getElementById('msg');
      msg.innerText='';
      if(newpass!==confirmpass){msg.style.color='red';msg.innerText='Passwords do not match!';return;}
      try{
        const resp=await fetch(`/reset_password/${token}`,{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({password:newpass})
        });
        const data=await resp.json();
        if(!resp.ok) throw new Error(data.error||'Error resetting password');
        msg.style.color='lightgreen';
        msg.innerText=data.message+' Redirecting...';
        setTimeout(()=>window.location.href='/',3000);
      }catch(e){msg.style.color='red';msg.innerText=e.message;}
    }
  </script>
</body>
</html>
